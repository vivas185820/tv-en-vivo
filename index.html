<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>TV Caribe Live</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
body { margin:0; background:#0a0a0a; color:white; font-family:Arial; }
header {
  background:#111;
  padding:10px;
  text-align:center;
  font-size:20px;
  position:sticky;
  top:0;
  z-index:10;
}
#player {
  width:100%;
  height:280px;
  background:black;
}
#menu {
  display:flex;
  justify-content:center;
  gap:15px;
  margin:10px;
}
.tab {
  padding:8px 16px;
  background:#e50914;
  border-radius:20px;
  cursor:pointer;
}
.tab.active { background:#ff3333; }
#search {
  width:95%;
  margin:10px auto;
  display:block;
  padding:10px;
  border-radius:20px;
  border:none;
}
.grid {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:10px;
  padding:10px;
}
.card {
  background:#1a1a1a;
  padding:10px;
  border-radius:8px;
  cursor:pointer;
  text-align:center;
}
.card:hover, .card.active { background:#333; }
</style>
</head>

<body>

<header>ðŸ“º TV Caribe Live</header>

<video id="player" controls autoplay></video>

<div id="menu">
  <div class="tab active" onclick="showTV()">ðŸ“¡ TV</div>
  <div class="tab" onclick="showRadio()">ðŸ“» Radios RD</div>
</div>

<input type="text" id="search" placeholder="ðŸ” Buscar canal o radio...">

<div class="grid" id="list"></div>

<script>
const tvListURL = "https://iptv-org.github.io/iptv/index.m3u";
const radiosRD = [
  {name:"Z101 FM", url:"https://stream.zeno.fm/7a1zq3zv7k8uv"},
  {name:"La Mega 97.7", url:"https://server2.srvif.com:9200/stream"},
  {name:"Rumba 98.5", url:"https://icecasthd.net:2199/tunein/rumba985.pls"},
  {name:"Caliente 104", url:"https://streaming.caliente104.com/stream"},
  {name:"Radio Universal", url:"https://streaming.radiouniversal.com.do/stream"}
];

let currentMode = "tv";
let items = [];
let selectedIndex = 0;

// Cargar IPTV
fetch(tvListURL).then(r=>r.text()).then(data=>{
  const lines = data.split("\n");
  for(let i=0;i<lines.length;i++){
    if(lines[i].startsWith("#EXTINF")){
      items.push({name:lines[i].split(",")[1], url:lines[i+1]});
    }
  }
  render(items);
  play(0);
});

function render(list){
  const grid = document.getElementById("list");
  grid.innerHTML="";
  list.forEach((it,i)=>{
    const div=document.createElement("div");
    div.className="card";
    div.innerText=it.name;
    div.onclick=()=>play(i);
    if(i===selectedIndex) div.classList.add("active");
    grid.appendChild(div);
  });
}

function play(i){
  selectedIndex=i;
  const video=document.getElementById("player");
  const url=items[i].url;
  if(Hls.isSupported() && currentMode==="tv"){
    const hls=new Hls();
    hls.loadSource(url);
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED,()=>video.play());
  } else {
    video.src=url;
    video.play();
  }
  render(items);
}

function showTV(){
  currentMode="tv";
  items=[];
  fetch(tvListURL).then(r=>r.text()).then(data=>{
    const lines=data.split("\n");
    for(let i=0;i<lines.length;i++){
      if(lines[i].startsWith("#EXTINF")){
        items.push({name:lines[i].split(",")[1], url:lines[i+1]});
      }
    }
    render(items);
    play(0);
  });
}

function showRadio(){
  currentMode="radio";
  items=radiosRD;
  render(items);
  play(0);
}

// Buscador
document.getElementById("search").addEventListener("input",function(){
  const t=this.value.toLowerCase();
  const filtered=items.filter(i=>i.name.toLowerCase().includes(t));
  render(filtered);
});

// Control remoto (TV)
document.addEventListener("keydown",function(e){
  if(e.key==="ArrowDown"){ if(selectedIndex<items.length-1) play(selectedIndex+1); }
  if(e.key==="ArrowUp"){ if(selectedIndex>0) play(selectedIndex-1); }
  if(e.key==="ArrowRight"){ if(selectedIndex<items.length-1) play(selectedIndex+1); }
  if(e.key==="ArrowLeft"){ if(selectedIndex>0) play(selectedIndex-1); }
  if(e.key==="Enter"){ play(selectedIndex); }
});
</script>

</body>
</html>